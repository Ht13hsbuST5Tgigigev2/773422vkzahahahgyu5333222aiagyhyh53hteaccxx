<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RBLX UI Designer</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">â–¦</div>
      <div class="brand-text">
        <div class="name">RBLX UI Designer</div>
        <div class="sub">Studio-like Â· Explorer parenting + ordering Â· Export Lua</div>
      </div>
    </div>

    <div class="topbar-actions">
      <button id="btnNew" class="btn ghost" title="New project">New</button>
      <button id="btnSave" class="btn ghost" title="Save to browser">Save</button>
      <button id="btnLoad" class="btn ghost" title="Load from browser">Load</button>
      <div class="divider"></div>
      <button id="btnExport" class="btn primary" title="Generate Roblox Lua script">Export Lua</button>
    </div>
  </header>

  <div class="workspace">
    <!-- LEFT: Toolbox + Explorer -->
    <aside class="left">
      <section class="panel">
        <div class="panel-title">
          <span>Toolbox</span>
          <div class="panel-actions">
            <button id="tabInstances" class="tabbtn active" type="button">Instances</button>
            <button id="tabUiObjects" class="tabbtn" type="button">UI Objects</button>
          </div>
        </div>

        <!-- Instances tab -->
        <div id="toolboxInstances" class="toolbox">
          <div class="toolgrid">
            <button class="tool small" data-create="Frame" title="Add Frame">
              <span class="tool-ico">â–­</span><span class="tool-text"><span class="tool-name">Frame</span></span>
            </button>
            <button class="tool small" data-create="ScrollingFrame" title="Add ScrollingFrame">
              <span class="tool-ico">â†•</span><span class="tool-text"><span class="tool-name">ScrollingFrame</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-create="TextLabel" title="Add TextLabel">
              <span class="tool-ico">T</span><span class="tool-text"><span class="tool-name">TextLabel</span></span>
            </button>
            <button class="tool small" data-create="TextButton" title="Add TextButton">
              <span class="tool-ico">â¦¿</span><span class="tool-text"><span class="tool-name">TextButton</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-create="TextBox" title="Add TextBox">
              <span class="tool-ico">âŒ¨</span><span class="tool-text"><span class="tool-name">TextBox</span></span>
            </button>
            <button class="tool small" data-create="ViewportFrame" title="Add ViewportFrame">
              <span class="tool-ico">â¬š</span><span class="tool-text"><span class="tool-name">ViewportFrame</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-create="ImageLabel" title="Add ImageLabel">
              <span class="tool-ico">ðŸ–¼</span><span class="tool-text"><span class="tool-name">ImageLabel</span></span>
            </button>
            <button class="tool small" data-create="ImageButton" title="Add ImageButton">
              <span class="tool-ico">ðŸ–¼â¦¿</span><span class="tool-text"><span class="tool-name">ImageButton</span></span>
            </button>
          </div>

          <div class="small muted pad12">
            â€¢ Drag inside the canvas to move, corner handles to resize<br/>
            â€¢ Drop onto Frame/ScrollingFrame to parent<br/>
            â€¢ Ordering: use Explorer (drag to reorder) or the Up/Down buttons<br/>
            â€¢ Delete only with <kbd>Del</kbd> (or right click â†’ Delete). Backspace will never delete.
          </div>
        </div>

        <!-- UI Objects tab -->
        <div id="toolboxUiObjects" class="toolbox" hidden>
          <div class="small muted pad12">
            UI Objects attach to the <b>selected</b> instance (like Studio).
          </div>

          <!-- Match the Studio-style UI objects list (plus a few common extras) -->
          <div class="toolgrid">
            <button class="tool small" data-add-ui="UIAspectRatioConstraint" title="Add UIAspectRatioConstraint">
              <span class="tool-ico">â§‰</span><span class="tool-text"><span class="tool-name">UIAspectRatioConstraint</span></span>
            </button>
            <button class="tool small" data-add-ui="UICorner" title="Add UICorner">
              <span class="tool-ico">â—œ</span><span class="tool-text"><span class="tool-name">UICorner</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-add-ui="UIGradient" title="Add UIGradient">
              <span class="tool-ico">â–¥</span><span class="tool-text"><span class="tool-name">UIGradient</span></span>
            </button>
            <button class="tool small" data-add-ui="UIGridLayout" title="Add UIGridLayout">
              <span class="tool-ico">â˜·</span><span class="tool-text"><span class="tool-name">UIGridLayout</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-add-ui="UIListLayout" title="Add UIListLayout">
              <span class="tool-ico">â‰¡</span><span class="tool-text"><span class="tool-name">UIListLayout</span></span>
            </button>
            <button class="tool small" data-add-ui="UIPadding" title="Add UIPadding">
              <span class="tool-ico">â–£</span><span class="tool-text"><span class="tool-name">UIPadding</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-add-ui="UIPageLayout" title="Add UIPageLayout">
              <span class="tool-ico">â–¤</span><span class="tool-text"><span class="tool-name">UIPageLayout</span></span>
            </button>
            <button class="tool small" data-add-ui="UIScale" title="Add UIScale">
              <span class="tool-ico">â¤¢</span><span class="tool-text"><span class="tool-name">UIScale</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-add-ui="UISizeConstraint" title="Add UISizeConstraint">
              <span class="tool-ico">â‡²</span><span class="tool-text"><span class="tool-name">UISizeConstraint</span></span>
            </button>
            <button class="tool small" data-add-ui="UIStroke" title="Add UIStroke">
              <span class="tool-ico">â–¢</span><span class="tool-text"><span class="tool-name">UIStroke</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-add-ui="UITableLayout" title="Add UITableLayout">
              <span class="tool-ico">â–¦</span><span class="tool-text"><span class="tool-name">UITableLayout</span></span>
            </button>
            <button class="tool small" data-add-ui="UITextSizeConstraint" title="Add UITextSizeConstraint">
              <span class="tool-ico">ðŸ” </span><span class="tool-text"><span class="tool-name">UITextSizeConstraint</span></span>
            </button>
          </div>

          <!-- Extra common Studio UI objects -->
          <div class="toolgrid">
            <button class="tool small" data-add-ui="UIFlexLayout" title="Add UIFlexLayout">
              <span class="tool-ico">â‡„</span><span class="tool-text"><span class="tool-name">UIFlexLayout</span></span>
            </button>
            <button class="tool small" data-add-ui="UIGridStyleLayout" title="(alias) UIGridLayout">
              <span class="tool-ico">â˜·</span><span class="tool-text"><span class="tool-name">UIGridStyleLayout</span></span>
            </button>
          </div>

          <div class="toolgrid">
            <button class="tool small" data-add-ui="UIListStyleLayout" title="(alias) UIListLayout">
              <span class="tool-ico">â‰¡</span><span class="tool-text"><span class="tool-name">UIListStyleLayout</span></span>
            </button>
            <button class="tool small" data-add-ui="UIConstraint" title="(placeholder) UIConstraint">
              <span class="tool-ico">â›“</span><span class="tool-text"><span class="tool-name">UIConstraint</span></span>
            </button>
          </div>

          <div class="small muted pad12">
            Note: Not every UI object affects preview visuals in the browser yet, but they will export to Lua.
          </div>
        </div>
      </section>

      <section class="panel grow">
        <div class="panel-title">
          Explorer
          <div class="panel-actions">
            <button id="btnMoveUp" class="iconbtn" title="Move up (higher ZIndex)">â†‘</button>
            <button id="btnMoveDown" class="iconbtn" title="Move down (lower ZIndex)">â†“</button>
            <button id="btnDuplicate" class="iconbtn" title="Duplicate selected">âŽ˜</button>
          </div>
        </div>

        <div class="explorer-hint">
          â€¢ Drag onto a Frame to parent<br/>
          â€¢ Drag above/below another item to reorder (render order) inside the same parent
        </div>

        <div id="explorer" class="explorer" aria-label="Explorer tree"></div>
      </section>
    </aside>

    <!-- CENTER: Canvas -->
    <main class="center">
      <div class="canvas-wrap">
        <div class="canvas-toolbar">
          <div class="canvas-meta">
            <span class="pill">ScreenGui</span>
            <span class="hint">Explorer controls parenting + ordering. Canvas drag drops into frames.</span>
          </div>

          <div class="canvas-controls">
            <label class="chk">
              <input id="chkSafeArea" type="checkbox" />
              <span>Safe area</span>
            </label>

            <label class="zoom">
              <span>Zoom</span>
              <input id="zoom" type="range" min="50" max="200" value="100" />
              <span id="zoomLabel" class="mono">100%</span>
            </label>
          </div>
        </div>

        <div class="canvas-outer" id="canvasOuter">
          <div class="safe-area" id="safeArea" hidden></div>
          <div id="canvas" class="canvas" aria-label="Design canvas"></div>
        </div>

        <div class="statusbar">
          <div id="statusLeft" class="status-left">Ready.</div>
          <div id="statusRight" class="status-right mono"></div>
        </div>
      </div>
    </main>

    <!-- RIGHT: Properties + Export -->
    <aside class="right">
      <section class="panel">
        <div class="panel-title">Project</div>
        <div class="form">
          <label class="field">
            <span class="label">ScreenGui Name</span>
            <input id="guiName" type="text" value="HelloWorldGui" />
          </label>

          <label class="field row">
            <span class="label">ResetOnSpawn</span>
            <select id="resetOnSpawn">
              <option value="false" selected>false</option>
              <option value="true">true</option>
            </select>
          </label>

          <label class="field row">
            <span class="label">Parent</span>
            <select id="guiParent">
              <option value="PlayerGui" selected>Players.LocalPlayer.PlayerGui</option>
              <option value="CoreGui">CoreGui (testing)</option>
            </select>
          </label>

          <label class="field row">
            <span class="label">Output</span>
            <select id="outputMode">
              <option value="variables" selected>Use variables</option>
              <option value="no-variables">No variables</option>
            </select>
          </label>
        </div>
      </section>

      <section class="panel grow">
        <div class="panel-title">Properties</div>

        <div id="emptyProps" class="empty">Select an element to edit properties.</div>

        <div id="props" class="props" hidden>
          <div class="props-grid">
            <div class="group-title">Core</div>

            <label class="field">
              <span class="label">Name</span>
              <input id="propName" type="text" />
            </label>

            <label class="field row">
              <span class="label">Parent</span>
              <select id="propParent">
                <option value="ROOT">ScreenGui (root)</option>
              </select>
            </label>

            <div class="field split">
              <div><span class="label">X</span><input id="propX" type="number" step="1" /></div>
              <div><span class="label">Y</span><input id="propY" type="number" step="1" /></div>
            </div>

            <div class="field split">
              <div><span class="label">W</span><input id="propW" type="number" step="1" /></div>
              <div><span class="label">H</span><input id="propH" type="number" step="1" /></div>
            </div>

            <label class="field row">
              <span class="label">Anchor</span>
              <select id="propAnchor">
                <option value="0,0">TopLeft (0,0)</option>
                <option value="0.5,0">Top (0.5,0)</option>
                <option value="1,0">TopRight (1,0)</option>
                <option value="0,0.5">Left (0,0.5)</option>
                <option value="0.5,0.5" selected>Center (0.5,0.5)</option>
                <option value="1,0.5">Right (1,0.5)</option>
                <option value="0,1">BottomLeft (0,1)</option>
                <option value="0.5,1">Bottom (0.5,1)</option>
                <option value="1,1">BottomRight (1,1)</option>
              </select>
            </label>

            <label class="field row">
              <span class="label">ZIndex</span>
              <input id="propZIndex" type="number" step="1" />
            </label>

            <div class="group-title">Appearance</div>

            <label class="field row">
              <span class="label">Background</span>
              <input id="propBgColor" type="color" value="#1e1e1e" />
            </label>

            <label class="field row">
              <span class="label">Background Î±</span>
              <input id="propBgAlpha" type="range" min="0" max="1" step="0.01" value="1" />
              <span id="propBgAlphaLabel" class="mono">1.00</span>
            </label>

            <label class="field row">
              <span class="label">Border</span>
              <select id="propBorder">
                <option value="true" selected>On</option>
                <option value="false">Off</option>
              </select>
            </label>

            <div class="group-title">Text</div>

            <label class="field">
              <span class="label">Text</span>
              <input id="propText" type="text" placeholder="TextLabel/TextButton/TextBox only" />
            </label>

            <label class="field row">
              <span class="label">Text Color</span>
              <input id="propTextColor" type="color" value="#ffffff" />
            </label>

            <label class="field row">
              <span class="label">TextScaled</span>
              <select id="propTextScaled">
                <option value="true" selected>true</option>
                <option value="false">false</option>
              </select>
            </label>

            <label class="field row">
              <span class="label">Font</span>
              <select id="propFont">
                <option value="SourceSans">SourceSans</option>
                <option value="SourceSansBold" selected>SourceSansBold</option>
                <option value="Gotham">Gotham</option>
                <option value="GothamBold">GothamBold</option>
                <option value="Arial">Arial</option>
                <option value="Code">Code</option>
              </select>
            </label>

            <div class="group-title">Image</div>
            <label class="field">
              <span class="label">Image</span>
              <input id="propImage" type="text" placeholder="rbxassetid://123 or https://..." />
            </label>

            <div class="group-title">ScrollingFrame</div>
            <div class="field split">
              <div><span class="label">Canvas W</span><input id="propCanvasW" type="number" step="1" /></div>
              <div><span class="label">Canvas H</span><input id="propCanvasH" type="number" step="1" /></div>
            </div>
            <label class="field row">
              <span class="label">ScrollBarThickness</span>
              <input id="propScrollBar" type="number" step="1" />
            </label>

            <div class="group-title">UI Objects</div>
            <div id="uiObjectsList" class="uiobjects"></div>
            <div class="small muted">Add from Toolbox â†’ UI Objects tab.</div>
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panel-title">Export</div>
        <div class="export">
          <textarea id="exportBox" class="mono" spellcheck="false" placeholder="Click â€œExport Luaâ€ to generate codeâ€¦" readonly></textarea>
          <div class="export-actions">
            <button id="btnCopy" class="btn" disabled>Copy</button>
            <button id="btnDownload" class="btn" disabled>Download .lua</button>
          </div>
          <div class="small muted">
            Exports parenting + ordering (ZIndex) + UI Objects (basic props).
          </div>
        </div>
      </section>
    </aside>
  </div>

  <footer class="footer">
    <span class="muted">
      Shortcuts: <kbd>Del</kbd> delete Â· <kbd>Ctrl</kbd>/<kbd>Cmd</kbd>+<kbd>D</kbd> duplicate Â·
      <kbd>Ctrl</kbd>/<kbd>Cmd</kbd>+<kbd>S</kbd> save Â· <kbd>Ctrl</kbd>/<kbd>Cmd</kbd>+<kbd>E</kbd> export
    </span>
  </footer>

  <!-- Right click context menu -->
  <div id="ctxMenu" class="ctxmenu" hidden>
    <button id="ctxDuplicate" type="button">Duplicate</button>
    <button id="ctxMoveUp" type="button">Move Up</button>
    <button id="ctxMoveDown" type="button">Move Down</button>
    <div class="ctxsep"></div>
    <button id="ctxDelete" class="danger" type="button">Delete</button>
  </div>

  <script src="./app.js" defer></script>
</body>
</html>
